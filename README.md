# Log2Exif

Googleマップのタイムライン（ロケーション履歴）データを利用して、写真（JPEG）の撮影日時から推測される位置情報（GPS）をEXIFデータとして付加するツールです。

## 特徴

- **Googleマップ タイムライン対応**: JSON形式のエクスポートデータを使用します。
- **自動マッチング**: 写真の撮影日時（EXIF情報またはファイルの更新日時）とタイムラインデータを照合し、最も近い時間の位置情報を付加します。
- **フォルダ構造の維持**: 処理後の画像は、元のフォルダ構造（サブフォルダなど）を維持したまま指定の出力先へ保存されます。
- **GUI操作**: フォルダ選択や設定を直感的に行えるGUIを提供します。前回の設定は自動的に保存されます。

## 前提条件

- Python 3.11 以上
- Windows OS (推奨)

## インストール

1. リポジトリをクローンまたはダウンロードします。
2. 必要なライブラリをインストールします。

```bash
pip install -r requirements.txt
```

## EXE版の使用（推奨）

Pythonがインストールされていない環境でも使用できるEXE版を提供しています。

### ダウンロード方法

1. [Releases](https://github.com/aliceD1540/Log2Exif/releases) ページにアクセス
2. 最新バージョンの `Log2Exif.exe` をダウンロード
3. ダウンロードしたEXEファイルをダブルクリックで起動

> [!NOTE]
> EXE版はmainブランチが更新されるたびにGitHub Actionsで自動的にビルドされます。
> タグが付いたバージョンは自動的にリリースページに公開されます。

## 使い方

### 1. データの準備

Googleマップのアプリまたはウェブサイトから、タイムラインデータをエクスポートしてください。
- スマートフォン（Android）の場合: [設定] -> [位置情報] -> [位置情報サービス] -> [タイムライン] からエクスポート可能です。
- 新しい形式の「Semantic Location History」のJSONファイルに対応しています。

### 2. アプリの起動

```bash
python main.py
```

### 3. 操作手順

1. **Timeline JSON**: エクスポートしたJSONファイルを選択します。
2. **Source Images Folder**: 位置情報を付加したい画像が入っているフォルダを選択します（サブフォルダも対象になります）。
3. **Destination Folder**: 処理後の画像を保存するフォルダを選択します。
4. **Overwrite**: 既に画像にGPS情報が含まれている場合、上書きするかどうかを選択します。
5. **Start Processing**: 処理を開始します。

## 開発者向け

### EXEのビルド方法

ローカル環境でEXEファイルをビルドする場合は、以下のコマンドを実行します。

#### Windows

```bash
build_exe.bat
```

ビルドが成功すると、`dist/Log2Exif.exe` ファイルが生成されます。

#### 手動ビルド

```bash
pip install pyinstaller
pyinstaller Log2Exif.spec
```

### リリース方法

新しいバージョンをリリースする場合は、以下の手順で行います。

1. バージョンタグを作成（例: `v1.0.0`）

```bash
git tag v1.0.0
git push origin v1.0.0
```

2. GitHub Actionsが自動的にEXEをビルドし、リリースを作成します
3. リリースノートは自動生成されますが、必要に応じて編集できます

> [!TIP]
> タグは [セマンティックバージョニング](https://semver.org/lang/ja/) に従って `vX.Y.Z` 形式で作成することを推奨します。

## ライセンス

[MIT License](LICENSE)
